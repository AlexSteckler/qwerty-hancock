(function(e,t){var n=function(t){var n=t.id||"keyboard",r=t.octaves||3,i=r*7,s=t.width||600,o=t.height||150,u=t.startNote||"A3",a=u.charAt(1),f=t.whiteNotesColour||"#FFF",l=t.blackNotesColour||"#000",c=t.hoverColour||"#076cf0",h=s/i,p=h/2,d=t.keyboardLayout||"en",v=new Raphael(n,s,o),m=["C","D","E","F","G","A","B"],g=["A","C","D","F","G"],y=0,b=u.charAt(0),w=a,E=a,S=false,x,T,N={},C=[],k=[],L=[];document.getElementById(n).style.fontSize="0px";var A=function(e){var t=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"],n;if(e.length===3){n=e.charAt(2)}else{n=e.charAt(1)}var r=t.indexOf(e.slice(0,-1));if(r<3){r=r+12+(n-1)*12+1}else{r=r+(n-1)*12+1}return 440*Math.pow(2,(r-49)/12)};for(var O=0;O<7;O++){if(b===m[O]){keyOffset=O;break}}for(O=0;O<7;O++){if(O+keyOffset>6){L[O]=m[O+keyOffset-7]}else{L[O]=m[O+keyOffset]}}for(O=0;O<i;O++){if(O%m.length===0){y=0}var M=L[y];if(M==="C"){w++}C[O]=v.rect(h*O,0,h,o).attr({id:L[y],title:L[y]+(w-1),fill:f}).mousedown(function(){S=true;this.attr({fill:c});x(this.attr("title"),A(this.attrs.title))}).mouseover(function(){if(S){this.attr({fill:c});x(this.attr("title"),A(this.attrs.title))}}).mouseup(function(){this.attr({fill:f});S=false;T(this.attr("title"),A(this.attrs.title))}).mouseout(function(){if(S){this.attr({fill:f});T(this.attr("title"),A(this.attrs.title))}});y++}w=a;for(O=0;O<i;O++){if(O%m.length===0){y=0}for(var _=0;_<g.length;_++){if(L[y]===g[_]){M=L[y]+"#";if(M==="C#"){w++}if(h*(O+1)<s){k[O]=v.rect(h*O+p*1.5,0,p,o/3*2).attr({id:L[y],title:L[y]+"#"+(w-1),fill:l}).mousedown(function(){S=true;this.attr({fill:c});x(this.attr("title"),A(this.attrs.title))}).mouseover(function(){if(S){this.attr({fill:c});x(this.attr("title"),A(this.attrs.title))}}).mouseup(function(){this.attr({fill:l});S=false;T(this.attr("title"),A(this.attrs.title))}).mouseout(function(){if(S){this.attr({fill:l});T(this.attr("title"),A(this.attrs.title))}})}}}y++}if(d=="en"){var D={65:"Cl",87:"C#l",83:"Dl",69:"D#l",68:"El",70:"Fl",84:"F#l",71:"Gl",89:"G#l",72:"Al",85:"A#l",74:"Bl",75:"Cu",79:"C#u",76:"Du",80:"D#u",186:"Eu",222:"Fu"}}else if(d=="de"){var D={65:"Cl",87:"C#l",83:"Dl",69:"D#l",68:"El",70:"Fl",84:"F#l",71:"Gl",90:"G#l",72:"Al",85:"A#l",74:"Bl",75:"Cu",79:"C#u",76:"Du",80:"D#u",186:"Eu",222:"Fu"}}var P=function(e){if(e.keyCode in N){return}N[e.keyCode]=true;for(var t=0;t<C.length;t++){if(typeof D[e.keyCode]!=="undefined"&&typeof C[t]!=="undefined"){var n=D[e.keyCode].replace("l",E).replace("u",(parseInt(E,10)+1).toString());if(C[t].attrs.title===n){C[t].attr({fill:c});x(C[t].attrs.title,A(C[t].attrs.title))}}}for(t=0;t<k.length;t++){if(typeof D[e.keyCode]!=="undefined"&&typeof k[t]!=="undefined"){n=D[e.keyCode].replace("l",E).replace("u",(parseInt(E,10)+1).toString());if(k[t].attrs.title===n){k[t].attr({fill:c});x(n,A(n))}}}};var H=function(e){delete N[e.keyCode];for(var t=0;t<C.length;t++){if(typeof D[e.keyCode]!=="undefined"&&typeof C[t]!=="undefined"){var n=D[e.keyCode].replace("l",E).replace("u",(parseInt(E,10)+1).toString());if(C[t].attrs.title===n){C[t].attr({fill:f});T(C[t].attrs.title,A(C[t].attrs.title))}}}for(t=0;t<k.length;t++){if(typeof D[e.keyCode]!=="undefined"&&typeof k[t]!=="undefined"){n=D[e.keyCode].replace("l",E).replace("u",(parseInt(E,10)+1).toString());if(k[t].attrs.title===n){k[t].attr({fill:l});T(n,A(n))}}}};e.onkeydown=P;e.onkeyup=H;var B=function(e){x=e};var j=function(e){T=e};return{keyDown:B,keyUp:j}};e.qwertyHancock=n})(window)
